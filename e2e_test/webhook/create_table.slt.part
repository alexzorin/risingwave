statement ok
create table rudderstack (
  data JSONB
) WITH (
  connector = 'webhook',
) VALIDATE SECRET test_secret AS secure_compare(
  headers->>'authorization',
  test_secret
);

statement ok
create table github_sha1 (
  data JSONB
) WITH (
  connector = 'webhook',
) VALIDATE SECRET test_secret AS secure_compare(
  headers->>'x-hub-signature',
  hmac(test_secret, data, 'sha1', 'sha1=')
);

statement ok
create table github_sha256 (
  data JSONB
) WITH (
  connector = 'webhook',
) VALIDATE SECRET test_secret AS secure_compare(
  headers->>'x-hub-signature-256',
  hmac(test_secret, data, 'sha256', 'sha256=')
);

statement ok
create table segment_sha1 (
  data JSONB
) WITH (
  connector = 'webhook',
) VALIDATE SECRET test_secret AS secure_compare(
  headers->>'x-signature',
  hmac(test_secret, data, 'sha1')
);
